<!-- Toast para notificaciones -->
<p-toast></p-toast>

<!-- Contenedor principal centrado -->
<div class="reset-password-container">
  <div class="reset-password-content">
    <!-- Logo y título -->
    <div class="header-section">
      <p-avatar
        icon="pi pi-shield"
        size="xlarge"
        [style]="{'background-color': '#1e40af', 'color': 'white'}">
      </p-avatar>
      <h1 class="app-title">NotarIA Digital</h1>
    </div>

    <!-- Tarjeta de reset password -->
    <div class="card-wrapper">
      <p-card styleClass="reset-password-card">
        <div class="card-header">
          <h2 class="form-title">Nueva Contraseña</h2>
          <p class="form-subtitle">Ingresa tu nueva contraseña</p>
        </div>

        <!-- Mensaje de error general -->
        @if (errorMessage()) {
          <p-message
            severity="error"
            [text]="errorMessage()"
            styleClass="w-full mb-4"
          ></p-message>
        }

        <!-- Mensaje informativo -->
        <p-message
          severity="info"
          text="La contraseña debe tener al menos 8 caracteres"
          styleClass="w-full mb-4"
        ></p-message>

        <!-- Formulario reactivo -->
        <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()" class="reset-password-form">

          <!-- Contraseña -->
          <div class="form-field">
            <label for="password" class="field-label">Nueva Contraseña</label>
            <p-password
              id="password"
              formControlName="password"
              [toggleMask]="true"
              [feedback]="false"
              placeholder="••••••••"
              styleClass="w-full"
              inputStyleClass="w-full"
              [ngClass]="{'ng-invalid ng-dirty': hasError('password')}"
            ></p-password>
            @if (hasError('password')) {
              <small class="error-message">
                {{ getErrorMessage('password') }}
              </small>
            }
          </div>

          <!-- Confirmar Contraseña -->
          <div class="form-field">
            <label for="confirmPassword" class="field-label">Confirmar Contraseña</label>
            <p-password
              id="confirmPassword"
              formControlName="confirmPassword"
              [toggleMask]="true"
              [feedback]="false"
              placeholder="••••••••"
              styleClass="w-full"
              inputStyleClass="w-full"
              [ngClass]="{'ng-invalid ng-dirty': hasError('confirmPassword')}"
            ></p-password>
            @if (hasError('confirmPassword')) {
              <small class="error-message">
                {{ getErrorMessage('confirmPassword') }}
              </small>
            }
          </div>

          <!-- Botón de envío -->
          <p-button
            type="submit"
            label="Restablecer Contraseña"
            [loading]="isLoading()"
            [disabled]="isLoading() || !token()"
            styleClass="w-full submit-button"
          ></p-button>
        </form>

        <!-- Link para volver al login -->
        <div class="footer-link">
          <p><a routerLink="/auth/login" class="login-link">Volver al inicio de sesión</a></p>
        </div>
      </p-card>
    </div>
  </div>
</div>
